# Build worker image (VM template)
image: Visual Studio 2015

# scripts that are called at very beginning, before repo cloning
init:
  - git config --global core.autocrlf input

# enable patching of AssemblyInfo.* files
assembly_info:
  patch: true
  file: AssemblyInfo.*
  assembly_version: "1.0.{build}"
  assembly_file_version: "{version}"
  assembly_informational_version: "{version}"

platform: Any CPU

configuration: Release

before_build:
  - nuget restore src/StrangerData.sln

build:
  parallel: true                  # enable MSBuild parallel builds
  project: src/StrangerData.sln   # path to Visual Studio solution or project
  publish_nuget: true             # package projects with .nuspec files and push to artifacts


deploy:
  - provider: NuGet
    server: https://www.nuget.org/api/v2/package
    api_key:
      secure: ingFtxQjecEsrc2Ma2S259/K78gtFObeHFmbiDo2LQnGzgDL0l4TbRY+F1COVmZo
    artifact: /.*\.nupkg/
    on:
      branch: master
